'use strict';
var db = require('../../db');
var Client = require('../models').Client;

/**
 * Controllers for the clients route
 * `/api/clients` and `/api/users/:id/clients/:client_id`
 * @type {Object}
 */
module.exports = {
  /**
   * Get a particular client (clientId) for particular user (userId)
   * @param  {Object} req Http request from client. Has no payload but has a url param for userId, and ClientId
   * @param  {Object} res Http response from client. JSON data with the client data.
   * @return { None }     Side-effect is the call on res.send with the date.
   */
  get: function(req, res){
    var userid = req.params.user_id;
    var clientid = req.params.client_id;
    res.send('got the get');
    // This is where we call the DB function for getting particualr client
  },
  post: function(req,res){
    var userid = req.params.user_id;
    // This is where we call the DB function for creating a new client
  },

  /**
   * Update a client record with clientId and data.
   * Reads from req.params for clientId.
   * Gets data from req.body
   * @param  {object} req http request object from client
   * @param  {object} res respons object generated by server
   * @return {undefined}     responds with client object JSON
   */
  put: function(req,res){
    var clientId = req.params.client_id;
    Client.update(clientId, req.body)
      .then(function(client){
        if (client) {
          res.json(client[0]);
        } else {
          throw new Error('Could not update record');
        }
      })
      .catch(function(err){
        res.status(204).send(err);
      });
    // This is where we call the DB function for updating a client
  }
};

